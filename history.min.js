/*!
 * History API JavaScript Library v4.0.6
 *
 * Support: IE6+, FF3+, Opera 9+, Safari, Chrome and other
 *
 * Copyright 2011-2013, Dmitrii Pakhtinov ( spb.piksel@gmail.com )
 *
 * http://spb-piksel.ru/
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 * Update: 2013-10-10 17:16
 */
(function(e){function L(){}function h(a,b,c){if(a&&!b){b=h();c=b.e;var f=b.h;a=/^(?:[\w0-9]+\:)?\/\//.test(a)?0===a.indexOf("/")?f+a:a:f+"//"+b.g+(0===a.indexOf("/")?a:0===a.indexOf("?")?c+a:0===a.indexOf("#")?c+b.f+a:c.replace(/[^\/]+$/g,"")+a)}else if(a=b?a:d.href,!r||c)a=a.replace(/^[^#]*/,"")||"#",a=d.protocol+"//"+d.host+n.basepath+a.replace(RegExp("^#[/]?(?:"+n.type+")?"),"");Q.href=a;a=/(?:([\w0-9]+:))?(?:\/\/(?:[^@]*@)?([^\/:\?#]+)(?::([0-9]+))?)?([^\?#]*)(?:(\?[^#]+)|\?)?(?:(#.*))?/.exec(Q.href);
b=a[2]+(a[3]?":"+a[3]:"");c=a[4]||"/";var f=a[5]||"",e="#"===a[6]?"":a[6]||"",l=c+f+e,w=c.replace(RegExp("^"+n.basepath,"i"),n.type)+f;return{a:a[1]+"//"+b+l,h:a[1],g:b,i:a[2],k:a[3]||"",e:c,f:f,b:e,c:l,j:w,d:w+e}}function aa(){var a="";if(D)a+=D.getItem(G);else{var b=m.cookie.split(G+"=");1<b.length&&(a+=b.pop().split(";").shift()||"null")}try{s=t.parse(a)||{}}catch(c){s={}}x(y+"unload",function(){if(D)D.setItem(G,t.stringify(s));else{var a={};if(a[d.href]=g.state)m.cookie=G+"="+t.stringify(a)}},
!1)}function z(a,b,c,f){c=c||{set:L};var d=!c.set,l=!c.get,w={configurable:!0,set:function(){d=1},get:function(){l=1}};try{E(a,b,w),a[b]=a[b],E(a,b,c)}catch(ka){}if(!d||!l)if(a.__defineGetter__&&(a.__defineGetter__(b,w.get),a.__defineSetter__(b,w.set),a[b]=a[b],c.get&&a.__defineGetter__(b,c.get),c.set&&a.__defineSetter__(b,c.set)),!(d&&l||a!==e)){try{var ba=a[b];a[b]=null}catch(p){}if("execScript"in e)e.execScript("Public "+b,"VBScript");else try{E(a,b,{value:L})}catch(h){}a[b]=ba}else if(!d||!l)try{try{var A=
H.create(a);E(H.getPrototypeOf(A)===a?A:a,b,c);for(var g in a)"function"===typeof a[g]&&(A[g]=a[g].bind(a));try{f.call(A,A,a)}catch(m){}a=A}catch(n){E(a.constructor.prototype,b,c)}}catch(q){return!1}return a}function ca(a,b,c){c=c||{};a=a===M?d:a;c.set=c.set||function(c){a[b]=c};c.get=c.get||function(){return a[b]};return c}function da(a,b,c){a in B?B[a].push(b):3<arguments.length?x(a,b,c,arguments[3]):x(a,b,c)}function ea(a,b,c){var e=B[a];if(e)for(a=e.length;--a;){if(e[a]===b){e.splice(a,1);break}}else R(a,
b,c)}function I(a,b){var c=(""+("string"===typeof a?a:a.type)).replace(/^on/,""),f=B[c];if(f){b="string"===typeof a?b:a;if(null==b.target)for(var d=["target","currentTarget","srcElement","type"];a=d.pop();)b=z(b,a,{get:"type"===a?function(){return c}:function(){return e}});(("popstate"===c?e.onpopstate:e.onhashchange)||L).call(e,b);for(var d=0,g=f.length;d<g;d++)f[d].call(e,b);return!0}return fa(a,b)}function S(){var a=m.createEvent?m.createEvent("Event"):m.createEventObject();a.initEvent?a.initEvent("popstate",
!1,!1):a.type="popstate";a.state=g.state;I(a)}function u(a,b,c,e){r||(b=h(b),b.c!==h().c&&(C=e,c?d.replace("#"+b.d):d.hash=b.d));!J&&a&&(s[d.href]=a);F=!1}function N(a){if(C){T!==d.href&&S();a=a||e.event;var b=h(C,!0),c=h();a.oldURL||(a.oldURL=b.a,a.newURL=c.a);b.b!==c.b&&I(a)}C=d.href}function U(a){setTimeout(function(){x("popstate",function(a){T=d.href;J||(a=z(a,"state",{get:function(){return g.state}}));I(a)},!1)},0);!r&&!0!==a&&g.location&&(V(g.location.hash),F&&(F=!1,S()))}function ga(a){a=a||
e.event;var b;a:{for(b=a.target||a.srcElement;b;){if("A"===b.nodeName)break a;b=b.parentNode}b=void 0}var c="defaultPrevented"in a?a.defaultPrevented:!1===a.returnValue;b&&"A"===b.nodeName&&!c&&(c=h(),b=h(b.getAttribute("href",2)),c.a.split("#").shift()===b.a.split("#").shift()&&b.b&&(c.b!==b.b&&(g.location.hash=b.b),V(b.b),a.preventDefault?a.preventDefault():a.returnValue=!1))}function V(a){var b=m.getElementById(a=(a||"").replace(/^#/,""));b&&b.id===a&&"A"===b.nodeName&&(a=b.getBoundingClientRect(),
e.scrollTo(K.scrollLeft||0,a.top+(K.scrollTop||0)-(K.clientTop||0)))}function ha(){var a=m.getElementsByTagName("script"),a=(a[a.length-1]||{}).src||"";(-1!==a.indexOf("?")?a.split("?").pop():"").replace(/(\w+)(?:=([^&]*))?/g,function(a,b,c){n[b]=(c||("basepath"===b?"/":"")).replace(/^(0|false)$/,"")});try{D=e.sessionStorage}catch(b){}ia();x(y+"hashchange",N,!1);var c=[M,v,ja,e,W,g];J&&delete W.state;for(var d=0;d<c.length;d+=2)for(var k in c[d])if(c[d].hasOwnProperty(k))if("function"===typeof c[d][k])c[d+
1][k]=c[d][k];else{a=ca(c[d],k,c[d][k]);if(!z(c[d+1],k,a,function(a,b){b===g&&(e.history=g=c[d+1]=a)}))return R(y+"hashchange",N,!1),!1;c[d+1]===e&&(B[k]=B[k.substr(2)]=[])}n.redirect&&g.redirect();!J&&t&&aa();if(!r)m[O](y+"click",ga,!1);"complete"===m.readyState?U(!0):(r||h().c===n.basepath||(F=!0),x(y+"load",U,!1));return!0}function ia(){function a(a){var b=[],d="VBHistoryClass"+(new Date).getTime()+c++,p=["Class "+d],f;for(f in a)if(a.hasOwnProperty(f)){var g=a[f];g&&(g.get||g.set)?(g.get&&p.push("Public "+
("_"===f?"Default ":"")+"Property Get ["+f+"]","Call VBCVal([(accessors)].["+f+"].get.call(me),["+f+"])","End Property"),g.set&&p.push("Public Property Let ["+f+"](val)",g="Call [(accessors)].["+f+"].set.call(me,val)\nEnd Property","Public Property Set ["+f+"](val)",g)):(b.push(f),p.push("Public ["+f+"]"))}p.push("Private [(accessors)]","Private Sub Class_Initialize()","Set [(accessors)]="+d+"FactoryJS()","End Sub","End Class","Function "+d+"Factory()","Set "+d+"Factory=New "+d,"End Function");e.execScript(p.join("\n"),
"VBScript");e[d+"FactoryJS"]=function(){return a};d=e[d+"Factory"]();for(p=0;p<b.length;p++)d[b[p]]=a[b[p]];return d}function b(a){var b=/[\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,c={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return b.test(a)?'"'+a.replace(b,function(a){return a in c?c[a]:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}var c=e.eval&&eval("/*@cc_on 1;@*/");
if(c&&!(7<+(/msie (\d+)/i.exec(navigator.userAgent)||[,8])[1])){var f=z,k=h().a,l=m.createElement("iframe");l.src="javascript:true;";l=K.firstChild.appendChild(l).contentWindow;e.execScript("Public history\nFunction VBCVal(o,r) If IsObject(o) Then Set r=o Else r=o End If End Function","VBScript");v={_:{get:M.toString}};g={back:q.back,forward:q.forward,go:q.go,emulate:null,_:{get:function(){return"[object History]"}}};t={parse:function(a){try{return(new Function("","return "+a))()}catch(b){return null}},
stringify:function(a){var c=(typeof a).charCodeAt(2);if(114===c)a=b(a);else if(109===c)a=isFinite(a)?String(a):"null";else if(111===c||108===c)a=String(a);else if(106===c)if(a){var d=(c="[object Array]"===H.prototype.toString.call(a))?"[":"{";if(c)for(var e=0;e<a.length;e++)d+=(0==e?"":",")+t.stringify(a[e]);else for(e in a)a.hasOwnProperty(e)&&(d+=(1==d.length?"":",")+b(e)+":"+t.stringify(a[e]));a=d+(c?"]":"}")}else a="null";else a="void 0";return a}};u=function(a,b,c,e,f){var g=l.document;b=h(b);
F=!1;if(b.c!==h().c||f){C=e;if(c)l.lfirst?(history.back(),u(a,b.a,0,e,1)):d.replace("#"+b.d);else if(b.a!=k||f)l.lfirst||(l.lfirst=1,u(a,k,0,e,1)),g.open(),g.write('<script>lfirst=1;parent.location.hash="'+b.d.replace(/"/g,'\\"')+'";\x3c/script>'),g.close();!f&&a&&(s[d.href]=a)}else a&&(s[d.href]=a)};z=function(b,c,d,h){f.apply(this,arguments)||(b===v?v[c]=d:b===g?(g[c]=d,"state"===c&&(v=a(v),e.history=g=a(g))):b[c]=d.get&&d.get());return b};setInterval(function(){var a=h().a;if(a!=k){var b=m.createEventObject();
b.oldURL=k;b.newURL=k=a;b.type="hashchange";N(b)}},100);e.JSON=t}}if(e.history){var m=e.document,K=m.documentElement,D=null,H=e.Object,t=e.JSON,d=e.location,q=e.history,g=q,P=q.pushState,X=q.replaceState,r=!!P,J="state"in q,E=H.defineProperty,v=z({},"t")?{}:m.createElement("a"),y="",O=e.addEventListener?"addEventListener":(y="on")&&"attachEvent",Y=e.removeEventListener?"removeEventListener":"detachEvent",Z=e.dispatchEvent?"dispatchEvent":"fireEvent",x=e[O],R=e[Y],fa=e[Z],n={basepath:"/",redirect:0,
type:"/"},G="__historyAPI__",Q=m.createElement("a"),C=d.href,T="",F=!1,s={},B={},ja={onhashchange:null,onpopstate:null},$=function(a,b){var c=e.history!==q;c&&(e.history=q);a.apply(q,b);c&&(e.history=g)},W={redirect:function(a,b){n.basepath=b=null==b?n.basepath:b;n.type=a=null==a?n.type:a;if(e.top==e.self){var c=h(null,!1,!0).c,f=d.pathname+d.search;r?(f=f.replace(/([^\/])$/,"$1/"),c!=b&&RegExp("^"+b+"$","i").test(f)&&d.replace(c)):f!=b&&(f=f.replace(/([^\/])\?/,"$1/?"),RegExp("^"+b,"i").test(f)&&
d.replace(b+"#"+f.replace(RegExp("^"+b,"i"),a)+d.hash))}},pushState:function(a,b,c){P&&$(P,arguments);u(a,c)},replaceState:function(a,b,c){delete s[d.href];X&&$(X,arguments);u(a,c,!0)},location:{set:function(a){e.location=a},get:function(){return r?d:v}},state:{get:function(){return s[d.href]||null}}},M={assign:function(a){0===(""+a).indexOf("#")?u(null,a):d.assign(a)},reload:function(){d.reload()},replace:function(a){0===(""+a).indexOf("#")?u(null,a,!0):d.replace(a)},toString:function(){return this.href},
href:{get:function(){return h().a}},protocol:null,host:null,hostname:null,port:null,pathname:{get:function(){return h().e}},search:{get:function(){return h().f}},hash:{set:function(a){u(null,(""+a).replace(/^(#|)/,"#"),!1,C)},get:function(){return h().b}}};ha()&&(g.emulate=!r,e[O]=da,e[Y]=ea,e[Z]=I)}})(window);
